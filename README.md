PXCJKutf8 Package
=================

LaTeX： upLaTeX で CJK パッケージを利用可能にする

CJK パッケージは欧文 (pdf)LaTeX での使用を前提にしているので、(u)pLaTeX
上で利用しようとすると、一部の CJK 文字が「pTeX の和文」として処理されて
しまうため失敗する。ところが、upTeX には `\disablecjktoken` プリミティブ
という「pTeX の和文」の認識を無効化する機能が存在するため、これを利用
すれば CJK パッケージの機能が正常となる。しかし「LaTeX の `\selectfont`
命令に対して pLaTeX カーネルと CJK の両方がパッチを当てていてそれらが
干渉する」という別の問題があるため、これだけでは upLaTeX の和文機能が
正常に動作しなくなってしまう。

本パッケージは「pLaTeX と CJK の両方のパッチを適用した `\selectfont`」
を再構成することにより、「正常な upLaTeX 上で CJK パッケージが正常に動作
する状態」を実現する。

※現状では、素の CJK パッケージではなく CJKutf8 パッケージを利用して
いる。このため、入力ファイルの文字コードは UTF-8 である必要がある。
また、パッケージの名前は「pxCJKutf8」である。

### 前提環境

  * フォーマット： LaTeX
  * エンジン： upTeX （派生エンジン含む）
      - pTeX でも一部機能が使用できる.
  * DVI ウェア： pTeX 対応のもの
  * 前提パッケージ： CJKutf8 （およびそれが依存するもの）
  * 入力ファイルの文字コードは UTF-8 である必要がある。

### インストール

  - `*.sty`         → $TEXMF/tex/platex/PXCJKutf8/

### ライセンス

MIT ライセンス

pxCJKutf8 パッケージ
--------------------

### パッケージ読込

    \usepackage[<オプション>]{pxCJKutf8}

本パッケージは内部で CJKutf8 パッケージを読み込む。（CJKutf8 パッケージ
は内部で CJK パッケージを読み込む。）本パッケージの読込時以前に CJK
パッケージを読み込んでは *いけない* 。

利用可能なオプションは以下の通り。

  * `forced`： 「`\selectfont` の再構成」が失敗した場合（CJK パッケージ
    が以前に読み込まれた場合など）のエラーを抑止して処理を強行する。
    この場合、`\selectfont` へのパッチを利用する（CJK 以外の）パッケージ
    の動作が不正になる可能性がある。

### 機能

本パッケージは「upLaTeX 上で CJKutf8 を動作させる」のが目的である。
従って、CJKutf8 パッケージの機能がそのまま利用できる。ちなみに、
CJKutf8 パッケージは「CJK パッケージと欧文の utf8 入力エンコーディング
を両方使えるようにしたもの」である。

pxCJKutf8 パッケージ独自の機能としては以下のものがある。

  * CJK 環境の先頭で自動的に `\disablecjktoken` を実行する。これにより、
    CJK 環境の内部で CJK 文字が「pTeX の和文」として扱われることを防止
    できる。

### 注意事項

pLaTeX 上で pxCJKutf8 を用いた場合、「`\disablecjktoken` が効かない」と
いう一点を除けば upLaTeX と同様に動作する。この場合、CJK 環境内の「JIS
X 0208 に含まれる文字」が「pTeX の和文」として扱われる。これは一般的には
致命的な欠点であるが、ハングル専用の韓国語を出力する場合にはあまり影響が
ないかも知れない。また、「CJK 環境内の CJK 文字を“エスケープ”する」
処理と組み合わせて利用することも考えられる。

更新履歴
--------

  * Version 0.2  〈2016/07/02〉
      - 最初の公開版

--------------------
Takayuki YATO (aka. "ZR")  
http://zrbabbler.sp.land.to/
